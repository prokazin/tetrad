<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=0" />
  <title>Telegram Trading Mini App — Demo</title>

  <!-- Telegram Web App meta (вставь свой web_app_url в BotFather и сюда при необходимости) -->
  <!-- Если используешь Telegram Web App: собирай BOT token в BotFather и укажи Web App URL -->
  <!-- Пример: https://your-vercel-app.vercel.app/ -->
  <meta name="telegram:bot_token" content="PUT_YOUR_BOT_TOKEN_HERE">

  <link rel="stylesheet" href="/style.css" />
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div id="app">
    <header class="app-header">
      <div class="brand">
        <img src="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' width='36' height='36'><rect width='36' height='36' rx='8' fill='%234A90E2'/><text x='18' y='23' font-size='16' fill='white' font-family='Arial' text-anchor='middle'>TR</text></svg>" alt="logo"/>
        <div>
          <h1>Trading Mini</h1>
          <small>Баланс: <span id="balanceDisplay">1000.00</span> $</small>
        </div>
      </div>
      <div class="header-actions">
        <button id="telegramShareBtn" title="Открыть в Telegram">TG</button>
      </div>
    </header>

    <nav class="tabs">
      <button class="tab-btn active" data-tab="trade">Торговля</button>
      <button class="tab-btn" data-tab="positions">Позиции</button>
      <button class="tab-btn" data-tab="history">История</button>
      <button class="tab-btn" data-tab="leaderboard">Рейтинг</button>
      <button class="tab-btn" data-tab="settings">Настройки</button>
    </nav>

    <main>
      <!-- TRADE -->
      <section class="tab" id="trade" style="display:block;">
        <div class="grid">
          <div class="panel">
            <label for="selectCoin">Монета</label>
            <select id="selectCoin"></select>

            <canvas id="priceChart" height="200"></canvas>
          </div>

          <div class="panel">
            <div class="card">
              <label>Выбор плеча</label>
              <div class="leverage-row">
                <button class="lev" data-lev="2">2x</button>
                <button class="lev" data-lev="5">5x</button>
                <button class="lev" data-lev="10">10x</button>
              </div>

              <label>Сумма для маржи ($)</label>
              <input id="marginInput" type="number" min="1" step="1" value="50" />

              <div class="side-row">
                <button id="buyBtn" class="long">LONG</button>
                <button id="sellBtn" class="short">SHORT</button>
              </div>

              <div class="info-block">
                <div>Текущая цена: <b id="priceNow">—</b></div>
                <div>Позиций сейчас: <b id="openCount">0</b></div>
                <div>Ожидаемая ликвидация: <b id="liquidationEst">—</b></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- POSITIONS -->
      <section class="tab" id="positions" style="display:none;">
        <div class="panel">
          <h2>Открытые позиции</h2>
          <div id="positionsList" class="positions-list"></div>
        </div>
      </section>

      <!-- HISTORY -->
      <section class="tab" id="history" style="display:none;">
        <div class="panel">
          <h2>История сделок</h2>
          <div id="historyList"></div>
        </div>
      </section>

      <!-- LEADERBOARD -->
      <section class="tab" id="leaderboard" style="display:none;">
        <div class="panel">
          <h2>Рейтинг игроков (локально)</h2>
          <div id="leaderboardList"></div>
        </div>
      </section>

      <!-- SETTINGS -->
      <section class="tab" id="settings" style="display:none;">
        <div class="panel">
          <h2>Настройки</h2>
          <label>Начальный баланс (для теста)</label>
          <input id="initialBalanceInput" type="number" value="1000" />
          <button id="resetBtn">Сбросить всё и начать заново</button>

          <p class="muted">Если хочешь хранить рейтинги/историю на сервере — посмотри папку backend/main.py и разверни API.</p>
        </div>
      </section>
    </main>

    <footer class="app-footer">
      <small>Demo Trading — мобильная оптимизация. Ликвидация = обнуление баланса при полном проигрыше.</small>
    </footer>
  </div>

  <script src="/script.js"></script>
</body>
</html>
